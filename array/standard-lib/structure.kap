namespace("kap")

defsyntax if (:value cond :nfunction thenStatement :optional (:constant else :nfunction elseStatement)) {
  ⍞((cond ≡ 1) ⌷ (⍞((isLocallyBound 'elseStatement) ⌷ λ{λ{⍬}} λ{elseStatement}) ⍬) thenStatement) cond
}

export(if else)

defsyntax while (:exprfunction cond :function body) {
  {if (⍞cond 0) { ⍞body 0 ◊ 0 } else { 1 }} ⍣ {⍵} 0
}

export(while)
